# Part 2
CREATE KEYSPACE andrew_73490641 WITH REPLICATION = { 'class': 'SimpleStrategy',
'replication_factor': 3 };
USE andrew_73490641;

# 2.1
CREATE TABLE students (student_ID text, student_name text, age int, 
major text, minor text, current_year int, cgpa decimal, total_credit int,
skills set<text>, PRIMARY KEY (student_ID) );

INSERT INTO students (student_ID, student_name, age, major, minor,
current_year, cgpa, total_credit, skills)
VALUES ('S101', 'Alex', 19, 'Computer Science','', 1, 3.85, 33, { });

INSERT INTO students (student_ID, student_name, age, major, minor,
current_year, cgpa, total_credit, skills)
VALUES ('S202', 'David', 23, 'Computer Science','', 4, 3.63, 87, 
{'Python', 'Java', 'Android'});

INSERT INTO students (student_ID, student_name, age, major, minor,
current_year, cgpa, total_credit, skills)
VALUES ('S103', 'Fred', 22, 'Computer Science','Math', 3, 3.76, 66, 
{'Android', 'Java', 'SQL'});

INSERT INTO students (student_ID, student_name, age, major, minor,
current_year, cgpa, total_credit, skills)
VALUES ('S104', 'Alex', 24, 'Physics','Math', 4, 3.52, 90, 
{'Android', 'Java', 'Python'});

INSERT INTO students (student_ID, student_name, age, major, minor,
current_year, cgpa, total_credit, skills)
VALUES ('S105', 'Jane', 20, 'Biology','', 2, 3.75, 27, {'Java'});

# 2.2
SELECT student_ID
FROM students
WHERE major = 'Computer Science' ALLOW FILTERING;

# 2.3
SELECT COUNT(student_ID) AS count
FROM students
WHERE student_name = 'Alex' ALLOW FILTERING;

# 2.4
SELECT student_name
FROM students
WHERE major = 'Computer Science' AND cgpa > 3.8 ALLOW FILTERING;

# 2.5
SELECT COUNT(student_ID) AS count
FROM students
WHERE skills CONTAINS 'Java' ALLOW FILTERING;

# 2.6
SELECT *
FROM students
WHERE cgpa > 3.6 AND skills CONTAINS 'Python' ALLOW FILTERING;

# 2.7
UPDATE students
SET skills = skills + {'R'}
WHERE student_ID = 'S202';

# 2.8
UPDATE students
SET skills = skills - {'Python'}
WHERE student_ID = 'S104';

# 2.9
SELECT AVG(age)
FROM students
WHERE major = 'Computer Science' ALLOW FILTERING;

# 2.10
ALTER TABLE students
ADD coop SET<text>;

# 2.11
UPDATE students
SET coop = {'BC Tree Fruit'}
WHERE student_ID = 'S101';













